parameters:
  synsights:
    namespace: syn-synsights

  system_upgrade_controller:
    plan_day: 2
    plan_hour: 7
    plan_tolerations:
      node-role.kubernetes.io/master:
        operator: Exists

    plans:
      system-upgrade-focal:
        spec:
          concurrency: 1
          upgrade:
            image: docker.io/projectsyn/suc-ubuntu-focal
            command: /scripts/run.sh
        push_gateway: platform-prometheus-pushgateway.${synsights:namespace}.svc.cluster.local:9091
        floodgate:
          day: ${system_upgrade_controller:plan_day}
          hour: ${system_upgrade_controller:plan_hour}
        label_selectors:
          plan.upgrade.cattle.io/system-upgrade-focal:
            operator: Exists
        tolerations: ${system_upgrade_controller:plan_tolerations}

      system-upgrade-bionic:
        spec:
          concurrency: 1
          upgrade:
            image: docker.io/projectsyn/suc-ubuntu-bionic
            command: /scripts/run.sh
        push_gateway: platform-prometheus-pushgateway.${synsights:namespace}.svc.cluster.local:9091
        floodgate:
          day: ${system_upgrade_controller:plan_day}
          hour: ${system_upgrade_controller:plan_hour}
        label_selectors:
          plan.upgrade.cattle.io/system-upgrade-bionic:
            operator: Exists
        tolerations: ${system_upgrade_controller:plan_tolerations}
